<!---
Copyright 2020 Marco Massarelli

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!DOCTYPE html>
<html>

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>Ugo-ESP32 Configuration</title>
        <link rel="stylesheet" type="text/css" href="common.css">
        </style>
        <style media="all and (max-width:520px)">
                .wrapper {
                        padding: 20px 0;
                }

                .c {
                        padding: 25px 15px;
                        border-radius: 0;
                }
        </style>
</head>

<body>
        <div class="wrapper">
                <div class="bat">
                        <p>Battery level: %BATTERY_CHARGING_OR_PERCENT_HTML% (%BATTERY_VOLTAGE%V)</p>
                        <div>
                                <div class="bat-%BATTERY_CLASS%"></div>
                        </div>
                </div>
                <div class="c">
                        <form method="post" action="/">
                                <h1>Ugo-ESP32 Configuration</h1>
                                <p>Press any button to go back to normal operation.</p>
                                <h2>Network settings</h2>
                                <p>Set your network credentials here.</p>
                                <div class="r"><label for="id">WiFi SSID</label><input type="text" id="id" name="id"
                                                value="%ID%">
                                </div>
                                <div class="r"><label for="pw">WiFi Password</label><input type="password" id="pw"
                                                name="pw" value="%PW%"></div>
                                <h2>Static IP settings (optional)</h2>
                                <p>In some cases this might speed up response time. IP, Gateway and Subnet need to be
                                        all set together,
                                        and IP should be reserved in
                                        the router's DHCP settings. Primary and secondary DNS are optional, and if not
                                        provided they will
                                        default to Google DNS (8.8.8.8 and 8.8.4.4).
                                        <br>To help you reserve the IP in your router, this is the MAC address of this
                                        device: <span class="mac">
                                                %MAC%
                                        </span></p>
                                <div class="r"><label for="ip">IP Address (optional):</label><input type="text" id="ip"
                                                name="ip" value="%IP%"></div>
                                <div class="r"><label for="gw">Gateway IP (optional):</label><input type="text" id="gw"
                                                name="gw" value="%GW%"></div>
                                <div class="r"><label for="sn">Subnet mask (optional):</label><input type="text" id="sn"
                                                name="sn" value="%SN%"></div>
                                <div class="r"><label for="d1">Primary DNS IP (optional):</label><input type="text"
                                                id="d1" name="d1" value="%D1%"></div>
                                <div class="r"><label for="d2">Secondary DNS IP (optional):</label><input type="text"
                                                id="d2" name="d2" value="%D2%"></div>
                                <h2>Button settings</h2>
                                <p>Assign a target URL for each button.<br>Use <b>[blvl]</b> shortcode to add battery
                                        percentage.<br>Use
                                        <b>[chrg]</b> shortcode to add battery voltage.<br>Use <b>[mac]</b> to add mac
                                        address (as unique
                                        identifier).<br>For example:
                                        "http://example.com/?trigger=button1&battery_percentage=[blvl]&mac=[mac]"</p>
                                <p>You can set MQTT topics to publish as a URI.<br>Use mqtt:// or mqtts:// as a
                                        protocol, optionally provide a user and password, then specify the broker
                                        address and port, finally the full topic as a path followed by the
                                        payload.<br>For example:
                                        "mqtt://username:password@192.168.1.202:1883/home-assistant/light/1/command?ON"
                                </p>
                                <div class="r"><label for="b1">Button 1 url</label><input type="text" id="b1" name="b1"
                                                value="%B1%">
                                </div>
                                <div class="r"><label for="b2">Button 2 url</label><input type="text" id="b2" name="b2"
                                                value="%B2%">
                                </div>
                                <div class="r"><label for="b3">Button 3 url</label><input type="text" id="b3" name="b3"
                                                value="%B3%">
                                </div>
                                <div class="r"><label for="b4">Button 4 url</label><input type="text" id="b4" name="b4"
                                                value="%B4%">
                                </div>
                                <h2>Button combinations</h2>
                                <p>Push two neighbouring buttons together and have them act as a virtual button.</p>
                                <div class="r"><label for="b5">B1+B2 url</label><input type="text" id="b5" name="b5"
                                                value="%B5%">
                                </div>
                                <div class="r"><label for="b6">B2+B3 url</label><input type="text" id="b6" name="b6"
                                                value="%B6%">
                                </div>
                                <div class="r"><label for="b7">B3+B4 url</label><input type="text" id="b7" name="b7"
                                                value="%B7%">
                                </div>
                                <h2>Home Assistant Integration (optional)</h2>
                                <p>The following section can be used to customize the settings for Home Assistant MQTT
                                        Discovery.</p>
                                </p>Set your MQTT credentials here. Leave them empty for anonymous connections.</p>
                                <div class="r"><label for="ha_user">User</label><input type="text" id="ha_user"
                                                name="ha_user" value="%HA_USER%">
                                </div>
                                <div class="r"><label for="ha_password">Password</label><input type="password"
                                                id="ha_password" name="ha_password" value="%HA_PASSWORD%"></div>
                                </p>Set your broker details, these are all required.</p>
                                <div class="r"><label for="ha_broker">Broker address</label><input type="text"
                                                id="ha_broker" name="ha_broker" value="%HA_BROKER%">
                                </div>
                                <div class="r"><label for="ha_port">Broker port</label><input type="text" id="ha_port"
                                                name="ha_port" value="%HA_PORT%">
                                </div>
                                </p>Customize your discovery topic prefix.</p>
                                <div class="r"><label for="ha_prefix">Discovery prefix</label><input type="text"
                                                id="ha_prefix" name="ha_prefix" value="%HA_PREFIX%">
                                </div>
                                <p> Once the following option is enabled, Ugo will publish device status (battery,
                                        voltage, which button was pressed) to Home Assistant every time it gets used,
                                        automatically.</p>
                                <p>NOTE: you will need to register this device on Home Assistant separately, for example
                                        using MQTT Discovery by pressing and holding B2+B4.</p>
                                <div class="r"><label for="ha_enabled">Enable auto-updates</label><input type="checkbox"
                                                id="ha_enabled" name="ha_enabled" %HA_ENABLED%>
                                </div>
                                <div class="r"><button type="submit">Save and reboot</button></div>
                        </form>
                </div>
                <div class="github">
                        <p>Firmware v%FIRMWARE_VERSION%, check out <a href="https://github.com/ceoloide/Ugo-ESP32"
                                        target="_blank"><strong>Ugo-ESP32</strong> on GitHub</a></p>
                </div>
        </div>
</body>

</html>